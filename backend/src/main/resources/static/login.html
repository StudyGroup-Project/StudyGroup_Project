<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<title>로그인</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			max-width: 400px;
			margin: 50px auto;
		}
		h1 { text-align: center; }
		.login-form, .oauth-login, .register-form {
			border: 1px solid #ddd;
			padding: 20px;
			margin-bottom: 20px;
			border-radius: 8px;
		}
		.login-form input, .register-form input {
			display: block;
			width: 95%;
			margin: 10px auto;
			padding: 10px;
		}
		button {
			display: block;
			width: 100%;
			margin: 10px 0;
			padding: 10px;
			border: none;
			border-radius: 5px;
			font-size: 14px;
			cursor: pointer;
		}
		.google { background: #4285F4; color: white; }
		.naver { background: #03C75A; color: white; }
		.kakao { background: #FEE500; color: #3C1E1E; }
		.error { color: red; font-size: 13px; text-align: center; }
		.success { color: green; font-size: 13px; text-align: center; }
	</style>
</head>
<body>

<h1>로그인</h1>

<!-- ✅ 시스템 로그인 -->
<form id="login-form" class="login-form" action="/api/auth/login" method="post">
	<input type="text" name="loginId" placeholder="아이디" required>
	<input type="password" name="password" placeholder="비밀번호" required>
	<button type="submit">로그인</button>
</form>

<!-- ✅ 회원가입 -->
<form id="register-form" class="register-form">
	<input type="text" name="loginId" placeholder="아이디" required>
	<input type="password" name="password" placeholder="비밀번호" required>
	<button type="submit">회원가입</button>
	<p id="register-message"></p>
</form>

<!-- ✅ OAuth 로그인 -->
<div class="oauth-login">
	<p style="text-align:center;">또는 소셜 계정으로 로그인</p>
	<a href="/oauth2/authorization/google"><button type="button" class="google">Google 로그인</button></a>
	<a href="/oauth2/authorization/naver"><button type="button" class="naver">Naver 로그인</button></a>
	<a href="/oauth2/authorization/kakao"><button type="button" class="kakao">Kakao 로그인</button></a>
</div>

</body>
</html>

<script>
	// ✅ 회원가입
	document.getElementById("register-form").addEventListener("submit", async function(e) {
		e.preventDefault();
		const loginId = e.target.loginId.value;
		const password = e.target.password.value;
		const messageBox = document.getElementById("register-message");
		messageBox.textContent = "";
		
		try {
			const response = await fetch("/api/auth/register", {
				method: "POST",
				headers: { "Content-Type": "application/json" },
				body: JSON.stringify({ loginId, password })
			});
			
			if (response.ok) {
				messageBox.textContent = "회원가입 성공! 이제 로그인하세요.";
				messageBox.className = "success";
			} else {
				const err = await response.json();
				messageBox.textContent = "회원가입 실패: " + (err.message || response.status);
				messageBox.className = "error";
			}
		} catch (err) {
			messageBox.textContent = "회원가입 요청 중 오류 발생: " + err;
			messageBox.className = "error";
		}
	});
</script>
